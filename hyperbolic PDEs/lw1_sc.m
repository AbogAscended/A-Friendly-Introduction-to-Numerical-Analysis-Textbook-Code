function w = lw1_sc ( a, b, NX, t0, tf, NT, ac, gc )x = linspace ( a, b, NX+1 );dx = ( b - a ) / NX;t = linspace ( t0, tf, NT+1 );dt = ( tf - t0 ) / NT;wold = zeros ( 1, NX+1 );wnew = zeros ( 1, NX+1 );for j = 1 : NX+1    wold(j) = ic ( x(j) );end;for n = 1 : NT    for j = 2 : NX        ajn = feval ( ac, t(n), x(j), wold(j) );		ajpn = feval ( ac, t(n), x(j)+0.5*dx, wold(j) );		ajmn = feval ( ac, t(n), x(j)-0.5*dx, wold(j) );		ajnp = feval ( ac, t(n)+0.5*dt, x(j), wold(j) );	    [gjn dgdt dgdx] = feval ( gc, t(n), x(j), wold(j) );				cd = ( wold(j+1) - wold(j-1) ) / ( 2 * dx );		fd = ( wold(j+1) - wold(j) ) / ( dx^2 );		bd = ( wold(j) - wold(j-1) ) / ( dx^2 );				wnew(j) = wold(j) - dt * ajnp * cd + (0.5*dt^2) * ajn * ( ajpn * fd - ajmn * bd ) + dt*gjn + (0.5*dt^2) * ( dgdt - ajn * dgdx );	end;	wold(2:NX) = wnew(2:NX);end;w = wold;function y = ic ( x )if ( ( -1 <= x ) & ( x <= 0 ) )   y = 1;else   y = 0;end;