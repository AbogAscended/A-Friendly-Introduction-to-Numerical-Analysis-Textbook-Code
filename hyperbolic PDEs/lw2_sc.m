function w = lw2_sc ( a, b, NX, t0, tf, NT, f, dfdu, gc )x = linspace ( a, b, NX+1 );dx = ( b - a ) / NX;t = linspace ( t0, tf, NT+1 );dt = ( tf - t0 ) / NT;wold = zeros ( 1, NX+1 );wnew = zeros ( 1, NX+1 );for j = 1 : NX+1    wold(j) = ic ( x(j) );end;for n = 1 : NT    for j = 2 : NX        fwj = feval ( f, wold(j) );		fwjm = feval ( f, wold(j-1) );		fwjp = feval ( f, wold(j+1) );				fujm1 = feval ( dfdu, wold(j-1) );		fujmh = feval ( dfdu, 0.5 * ( wold(j-1) + wold(j) ) );		fuj   = feval ( dfdu, wold(j) );		fujph = feval ( dfdu, 0.5 * ( wold(j+1) + wold(j) ) );		fujp1 = feval ( dfdu, wold(j+1) );			    [gjn dgdt dgdx] = feval ( gc, t(n), x(j), wold(j) );				cd = ( fwjp - fwjm ) / ( 2 * dx );		fd = ( fwjp - fwj ) / ( dx^2 );		bd = ( fwj - fwjm ) / ( dx^2 );		dfcd = ( fujp1 - fujm1 ) / ( 2 * dx );				wnew(j) = wold(j) - dt * cd + (0.5*dt^2) * ( fujph * fd - fujmh * bd ) + dt*gjn + (0.5*dt^2) * ( dgdt - fuj * dgdx - gjn * dfcd );	end;	wold(2:NX) = wnew(2:NX);end;w = wold;function y = ic ( x )if ( ( 0 <= x ) & ( x <= 1 ) )   y = 1 - cos(2*pi*x);else   y = 0;end;%if ( x < -1 )%   y = 40;%elseif ( x < 1 )%   y = 100 + 60*cos(pi*x);%else%   y = 40;%end;