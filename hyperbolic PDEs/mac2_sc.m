function w = mac2_sc ( a, b, NX, t0, tf, NT, f, gc )x = linspace ( a, b, NX+1 );dx = ( b - a ) / NX;t = linspace ( t0, tf, NT+1 );dt = ( tf - t0 ) / NT;wold = zeros ( 1, NX+1 );wstar = zeros ( 1, NX+1 );wnew = zeros ( 1, NX+1 );for j = 1 : NX+1    wold(j) = ic ( x(j) );end;for n = 1 : NT    for j = 1 : NX        fj = feval ( f, wold(j) );		fjp = feval ( f, wold(j+1) );	    gjn = feval ( gc, t(n), x(j), wold(j) );		wstar(j) = wold(j) - (dt/dx) * ( fjp - fj ) + dt * gjn;	end;		for j = 2 : NX        fjs = feval ( f, wstar(j) );		fjsm = feval ( f, wstar(j-1) );	    gjs = feval ( gc, t(n+1), x(j), wstar(j) );		wnew(j) = 0.5 * ( wold(j) + wstar(j) - (dt/dx) * ( fjs - fjsm ) + dt * gjs );	end;	wold(2:NX) = wnew(2:NX);end;w = wold;function y = ic ( x )%if ( ( 0 <= x ) & ( x <= 1 ) )%   y = 1 - cos(2*pi*x);%    y = 1;%else%   y = 0;%end;if ( ( x <= -1 ) )   y = 40;elseif ( x < 1 )   y = 100 + 60*cos(pi*x);else   y = 40;end;