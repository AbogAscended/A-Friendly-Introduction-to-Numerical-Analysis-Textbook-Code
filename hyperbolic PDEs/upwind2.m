function [C,H] = upwind2 ( NX, tf, NT )x = linspace ( 0, 3, NX+1 );dx = 3 / NX;t = linspace ( 0, tf, NT+1 );dt = tf / NT;Cold = zeros ( 1, NX+1 );Hold = zeros ( 1, NX+1 );Cnew = zeros ( 1, NX+1 );Hnew = zeros ( 1, NX+1 );for j = 1 : NX+1    Cold(j) = 20;	Hold(j) = 20;end;Cold(1) = 5;Hold(NX+1) = 60;vc = 0.1;vh = 0.1;gc = 20 * .4 / ( 1 * 1007 * 0.1 );for n = 1 : NT    for j = 2 : NX+1	    Cnew(j) = Cold(j) + (vc*dt/dx) * ( Cold(j-1) - Cold(j) ) + dt*gc*(Hold(j)-Cold(j));    end;	for j = NX : -1 : 1		Hnew(j) = Hold(j) - (vh*dt/dx) * ( Hold(j) - Hold(j+1) ) + dt*gc*(Cold(j)-Hold(j));	end;	Cold(2:NX+1) = Cnew(2:NX+1);	Hold(1:NX) = Hnew(1:NX);end;C = Cold;H = Hold;