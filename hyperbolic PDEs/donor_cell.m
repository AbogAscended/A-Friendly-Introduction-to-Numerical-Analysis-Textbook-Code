function [w, exact] = donor_cell ( a, b, NX, t0, tf, NT, ac, gc )x = linspace ( a, b, NX+1 );dx = ( b - a ) / NX;t = linspace ( t0, tf, NT+1 );dt = ( tf - t0 ) / NT;wold = zeros ( 1, NX+1 );wnew = zeros ( 1, NX+1 );an   = zeros ( 1, NX+1 );for j = 1 : NX+1    wold(j) = ic ( x(j) );end;for n = 1 : NT%    if ( t(n+1) < 1 )        wnew(1) = 0;       wnew(NX+1) = 0;%	else%	   wnew(NX+1) = 0;%	end;    for j = 1 : NX+1        an(j) = feval ( ac, t(n), x(j), wold(j) );	end;	for j = 2 : NX	    gjn = feval ( gc, t(n), x(j), wold(j) );		aL = 0.5 * ( an(j-1) + an(j) );		aR = 0.5 * ( an(j) + an(j+1) );		if ( aL > 0 ) wL = wold(j-1); else wL = wold(j); end;		if ( aR > 0 ) wR = wold(j); else wR = wold(j+1); end;	    wnew(j) = wold(j) + (dt/dx) * ( aL * wL - aR * wR ) + dt*gjn;	end;%	wold(2:NX+1) = wnew(2:NX+1);    wold = wnew;end;w = wold;exact = zeros ( 1, NX+1 );for j = 1 : NX+1    numer = ( 1 + x(j) ) * exp(-2*tf) - ( 1 - x(j) );	denom = ( 1 - x(j) ) + ( 1 + x(j) ) * exp(-2*tf);    exact(j) = ic ( numer / denom );end;function y = ic ( x )%if ( ( 0.5 <= x ) & ( x <= 1) )   y = 1 + cos(pi*x);%else%   y = 0;%end;function y = bc4 ( t ) %if ( t < 1 )   y = t;%else%   y = 0;%end;