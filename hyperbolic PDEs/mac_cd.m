function w = mac_cd ( a, b, NX, t0, tf, NT, D, vel )x = linspace ( a, b, NX+1 );dx = ( b - a ) / NX;t = linspace ( t0, tf, NT+1 );dt = ( tf - t0 ) / NT;mu = D * dt / dx^2;wold = zeros ( 1, NX+1 );wstar = zeros ( 1, NX+1 );wnew = zeros ( 1, NX+1 );u = zeros ( 1, NX+1 );for j = 1 : NX+1    wold(j) = ic ( x(j) );end;%wold(1) = 1;for j = 1 : NX+1    u(j) = feval ( vel, x(j) );end;for n = 1 : NT    for j = 2 : NX		wstar(j) = wold(j) + (dt/dx) * ( u(j)*wold(j) - u(j+1)*wold(j+1) ) + mu * ( wold(j-1) - 2*wold(j) + wold(j+1) );	end;%	wstar(1) = 1 - exp(-20*t(n+1));%	wstar(NX+1) = 0;		for j = 2 : NX		wnew(j) = 0.5 * ( wold(j) + wstar(j) - (dt/dx) * ( u(j)*wstar(j) - u(j-1)*wstar(j-1) ) + mu * ( wstar(j-1) - 2*wstar(j) + wstar(j+1) ) );	end;%	wnew(NX+1) = t(n+1)^2;	wold(2:NX) = wnew(2:NX);end;w = wold;function y = ic ( x )if ( ( 0 <= x ) & ( x <= 1 ) )   y = 1 - cos(2*pi*x);else   y = 0;end;