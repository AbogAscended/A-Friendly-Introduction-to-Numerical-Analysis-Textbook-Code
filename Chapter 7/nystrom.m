function [wi, ti] = nystrom ( RHS, t0, x0, tf, N )neqn = length ( x0 );ti = linspace ( t0, tf, N+1 );wi = [ zeros( neqn, N+1 ) ];wi(1:neqn, 1) = x0';h = ( tf - t0 ) / N;for i = 1:N    k1 = h * feval ( RHS, t0, x0 );	k2 = h * feval ( RHS, t0 + 2*h/3, x0 + 2*k1/3 );	k3 = h * feval ( RHS, t0 + 2*h/3, x0 + 2*k2/3 );    x0 = x0 + (1/4)*k1 + (3/8)*k2 + (3/8)*k3;	t0 = t0 + h;	    wi(1:neqn,i+1) = x0';	end;