function [ti, wi] = midpoint ( RHS, t0, x0, tf, N )neqn = length ( x0 );if ( nargout > 0 )   ti = [ t0 zeros( 1, N ) ];   wi = [ zeros( neqn, N+1 ) ];   wi(1:neqn, 1) = x0';end;h = ( tf - t0 ) / N;for i = 1:N    f1 = feval ( RHS, t0, x0 );	xtilde = x0 + (h/2) * f1;    x0 = x0 + h * feval ( RHS, t0+h/2, xtilde );	t0 = t0 + h;    if ( nargout > 0 )       ti(i+1) = t0;       wi(1:neqn, i+1) = x0';    end;	end;