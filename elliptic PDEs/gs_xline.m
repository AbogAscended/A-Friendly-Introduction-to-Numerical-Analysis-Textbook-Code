function [w, x, y, rn] = gs_xline ( a, b, N, c, d, M, f, g, TOL, Nmax )x = linspace ( a, b, N+1 );y = linspace ( c, d, M+1 );h = (b-a)/N;hsq = h*h;if ( nargout > 3 ) rn = zeros ( 1, Nmax ); end;w = zeros ( N+1, M+1 );for i = 1 : N+1    w(i,  1) = feval ( g, x(i), y(1) );	w(i,M+1) = feval ( g, x(i), y(M+1) );end;for j = 2 : M    w(1,  j) = feval ( g, x(1), y(j) );	w(N+1,j) = feval ( g, x(N+1), y(j) );end;fmat = zeros ( N+1, M+1 );for i = 2 : N    for j = 2 : M	    fmat(i,j) = hsq * feval ( f, x(i), y(j) );	end;end;c = -ones ( M-2, 1 );a = 4 * ones ( M-1, 1 );b = c;for its = 1 : Nmax    res_norm = 0;		for i = 2 : N	    rhs = w(i-1,2:M) + w(i+1,2:M) - fmat(i,2:M);        rhs(1) = rhs(1) + w(i,1);		rhs(M-1) = rhs(M-1) + w(i,M+1);		new = tridiagonal ( c, a, b, rhs );		res = w(i,2:M) - new;	    w(i,2:M) = new;		if ( max ( abs ( res ) ) > res_norm ) res_norm = max(abs(res)); end;	end;		if ( nargout > 3 ) rn(its) = res_norm; end;	if ( res_norm < TOL ) w = w; disp(its); return; end;end;w = wold; 	   