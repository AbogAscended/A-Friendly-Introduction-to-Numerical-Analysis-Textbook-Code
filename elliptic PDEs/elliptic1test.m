function [w, x, y] = elliptic1 ( a, b, N, c, d, M, f, g, alpha )x = linspace ( a, b, N+1 );y = linspace ( c, d, M+1 );h = (b-a)/N;hsq = h*h;w = zeros ( M+1, N+1 );for i = 1 : N+1	w(M+1,i) = feval ( g, x(i), y(M+1) );end;for j = 1 : M    w(j,  1) = feval ( g, x(1), y(j) );	w(j,N+1) = feval ( g, x(N+1), y(j) );end;diag = 4 * eye ( N-1 );for i = 1 : N-2    diag(i+1,i) = -1;	diag(i,i+1) = -1;end;A = zeros ( (N-1)*M, (N-1)*M );A ( 1:(N-1), 1:(N-1) ) = eye ( N - 1 );for i = 2 : M    A ( 1+(i-1)*(N-1):i*(N-1), 1+(i-1)*(N-1):i*(N-1) ) = diag;end;A ( 1:(N-1), N:2*(N-1) ) = -eye ( N-1 );A ( N:2*(N-1), 1:(N-1) ) = - eye ( N-1 );for i = 2 : M-1    A ( 1+(i-1)*(N-1):i*(N-1), 1+i*(N-1):(i+1)*(N-1) ) = - eye ( N-1 );	A ( 1+i*(N-1):(i+1)*(N-1), 1+(i-1)*(N-1):i*(N-1) ) = - eye ( N-1 );end;for j = 1 : M    for i = 1 : N-1	    loc = i + (j-1)*(N-1);		rhs(loc) = -hsq * feval ( f, x(i+1), y(j) );		if ( i == 1 ) rhs(loc) = rhs(loc) + w(j,1); end;		if ( i == N-1 ) rhs(loc) = rhs(loc) + w(j,N+1); end;		if ( j == 1 ) rhs(loc) = h*feval ( alpha, x(i+1) ); end;		if ( j == M ) rhs(loc) = rhs(loc) + w(M+1,i+1); end;	end;end;[A, pvt] = LUfactor ( A );w1 = LUsolve ( A, rhs, pvt );for loc = 1 : (N-1)*M    r = 1 + floor ( (loc-1) / (N-1) );	c = 1 + mod ( (loc-1), (N-1) );	w(r,c+1) = w1(loc);end;