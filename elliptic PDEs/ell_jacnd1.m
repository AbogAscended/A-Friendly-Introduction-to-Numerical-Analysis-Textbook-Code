function [w, x, y, rn] = ell_jacnd1 ( a, b, N, c, d, M, f, g, alpha, TOL, Nmax )x = linspace ( a, b, N+1 );y = linspace ( c, d, M+1 );h = (b-a)/N;hsq = h*h;if ( nargout > 3 ) rn = zeros ( 1, Nmax ); end;wold = zeros ( N+1, M+1 );for i = 1 : N+1    wold(i,M+1) = feval ( g, x(i), y(M+1) );end;for j = 2 : M+1    wold(1,  j) = feval ( g, x(1), y(j) );	wold(N+1,j) = feval ( g, x(N+1), y(j) );end;fmat = zeros ( N+1, M+1 );for i = 1 : N+1    for j = 1 : M+1	    fmat(i,j) = hsq * feval ( f, x(i), y(j) );	end;end;for its = 1 : Nmax    res_norm = 0;		for i = 2:N	    new = 0.25 * ( wold(i-1,1) + wold(i+1,1) + 2*wold(i,2) - fmat(i,1) - 2*h*feval ( alpha, x(i) ) );        res = wold(i,1) - new;	    wnew(i,1) = new;		if ( abs ( res ) > res_norm ) res_norm = abs(res); end;	end;		for j = 2 : M	    for i = 2 : N		    new = 0.25 * ( wold(i-1,j) + wold(i+1,j) + wold(i,j-1) + wold(i,j+1) - fmat(i,j) );            res = wold(i,j) - new;			wnew(i,j) = new;			if ( abs ( res ) > res_norm ) res_norm = abs(res); end;		end;	end;	wold(2:N,1:M) = wnew(2:N,1:M);	if ( nargout > 3 ) rn(its) = res_norm; end;		if ( res_norm < TOL ) w = wold; disp(its); return; end;end; w = wold;	   