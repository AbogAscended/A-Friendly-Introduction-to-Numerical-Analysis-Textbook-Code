function [w, x, y] = elliptic5 ( a, b, N, c, d, M, f, g, alpha, pqr )x = linspace ( a, b, N+1 );y = linspace ( c, d, M+1 );h = (b-a)/N;hsq = h*h;w = zeros ( M+1, N+1 );for i = 1 : N+1    w(  1,i) = feval ( g, x(i), y(1) );end;diag = 4 * eye ( N+1 );diag(1,2) = -2;diag(2,1) = -1;for i = 2 : N-1    diag(i+1,i) = -1;	diag(i,i+1) = -1;end;diag(N,N+1) = -1;diag(N+1,N) = -2;[p q r] = feval ( pqr, y(1) );diag(N+1,N+1) = diag(N+1,N+1) + 2*h*q/p;A = zeros ( (N+1)*M, (N+1)*M );for i = 1 : M    A ( 1+(i-1)*(N+1):i*(N+1), 1+(i-1)*(N+1):i*(N+1) ) = diag;end;for i = 1 : M-2    A ( 1+(i-1)*(N+1):i*(N+1), 1+i*(N+1):(i+1)*(N+1) ) = - eye ( N+1 );	A ( 1+i*(N+1):(i+1)*(N+1), 1+(i-1)*(N+1):i*(N+1) ) = - eye ( N+1 );end;A ( 1+(M-2)*(N+1):(M-1)*(N+1), 1+(M-1)*(N+1):M*(N+1) ) = - eye ( N+1 );A ( 1+(M-1)*(N+1):M*(N+1), 1+(M-2)*(N+1):(M-1)*(N+1) ) = - 2*eye ( N+1 );for j = 1 : M    for i = 1 : N+1	    loc = i + (j-1)*(N+1);		rhs(loc) = -hsq * feval ( f, x(i), y(j+1) );		if ( i == 1 ) rhs(loc) = rhs(loc) + 2*h*feval ( alpha, y(j+1) ); end;		if ( i == N+1 ) 		   [p q r] = feval ( pqr, y(j+1) );		   rhs(loc) = rhs(loc) + 2*h*r/p; 		end;		if ( j == 1 ) rhs(loc) = rhs(loc) + w(1,i); end;		if ( j == M ) rhs(loc) = rhs(loc) + 2*h*feval ( alpha, y(j+1) ); end;	end;end;[A, pvt] = factor ( A );w1 = solve ( A, rhs, pvt );for loc = 1 : (N+1)*M    r = 1 + floor ( (loc-1) / (N+1) );	c = 1 + mod ( (loc-1), (N+1) );	w(r+1,c) = w1(loc);end;