function [w, x, y] = trap_bar ( N, TOL, Nmax )x = linspace ( 0, 30, N+1 );y = linspace ( 0, 40, 2*N+1 );deltax = 30/N;deltay = 20/N;dx2 = deltax * deltax;lambda = dx2 / ( deltay * deltay );w = zeros ( N+1, 2*N+1 );for j = 1 : 2*N+1    w(N+1,j) = 100;end;for j = 1 : N+1    w(1,j) = 0;end;fmat = zeros ( 3*N+1, 2*N+1 );for its = 1 : Nmax    res_norm = 0;	for i = 2 : N		res = fmat(i,1) - ( w(i-1,1) + w(i+1,1) + 2 * lambda * w(i,2) - 2 * ( 1 + lambda ) * w(i,1) );	    w(i,1) = w(i,1) - res/ ( 2 * ( 1 + lambda ) );		if ( abs ( res ) > res_norm ) res_norm = abs(res); end;	end;	for j = 2 : N+1	    for i = 2 : N		    res = fmat(i,j) - ( w(i-1,j) + w(i+1,j) + lambda * w(i,j-1) + lambda * w(i,j+1) - 2 * ( 1 + lambda ) * w(i,j) );			w(i,j) = w(i,j) - res/ ( 2 * ( 1 + lambda ) );			if ( abs ( res ) > res_norm ) res_norm = abs(res); end;		end;	end;		for j = N+2 : 2*N		res = fmat(j-N,j) - ( 2 * w(j-N+1,j) + 2 * lambda * w(j-N,j-1) - 2 * ( 1 + lambda ) * w(j-N,j) );	    w(j-N,j) = w(j-N,j) - res/ ( 2 * ( 1 + lambda ) );		if ( abs ( res ) > res_norm ) res_norm = abs(res); end;	    for i = j-N+1 : N		    res = fmat(i,j) - ( w(i-1,j) + w(i+1,j) + lambda * w(i,j-1) + lambda * w(i,j+1) - 2 * ( 1 + lambda ) * w(i,j) );			w(i,j) = w(i,j) - res/ ( 2 * ( 1 + lambda ) );			if ( abs ( res ) > res_norm ) res_norm = abs(res); end;		end;	end;		if ( res_norm < dx2*TOL ) disp(its); return; end;end; 	   