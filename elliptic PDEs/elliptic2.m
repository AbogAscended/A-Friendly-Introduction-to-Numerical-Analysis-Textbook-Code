function [w, x, y] = elliptic2 ( a, b, N, c, d, M, f, g, alpha, pqr )x = linspace ( a, b, N+1 );y = linspace ( c, d, M+1 );h = (b-a)/N;hsq = h*h;w = zeros ( M+1, N+1 );for i = 1 : N+1    w(  1,i) = feval ( g, x(i), y(1) );end;for j = 2 : M+1    w(j,  1) = feval ( g, x(1), y(j) );end;diag = 4 * eye ( N );for i = 1 : N-2    diag(i+1,i) = -1;	diag(i,i+1) = -1;end;diag(N-1,N) = -1;diag(N,N-1) = -2;A = zeros ( N*M, N*M );for i = 1 : M    A ( 1+(i-1)*N:i*N, 1+(i-1)*N:i*N ) = diag;end;for i = 1 : N    [p q r] = feval ( pqr, x(i+1) );	A ( i+(M-1)*N, i+(M-1)*N ) = A ( i+(M-1)*N, i+(M-1)*N ) + 2*h*q/p;end;for i = 1 : M-2    A ( 1+(i-1)*N:i*N, 1+i*N:(i+1)*N ) = - eye ( N );	A ( 1+i*N:(i+1)*N, 1+(i-1)*N:i*N ) = - eye ( N );end;A ( 1+(M-2)*N:(M-1)*N, 1+(M-1)*N:M*N ) = - eye ( N );A ( 1+(M-1)*N:M*N, 1+(M-2)*N:(M-1)*N ) = - 2*eye ( N );for j = 1 : M    for i = 1 : N	    loc = i + (j-1)*N;		rhs(loc) = -hsq * feval ( f, x(i+1), y(j+1) );		if ( i == 1 ) rhs(loc) = rhs(loc) + w(j+1,1); end;		if ( i == N ) rhs(loc) = rhs(loc) + 2*h*feval ( alpha, y(j+1) ); end;		if ( j == 1 ) rhs(loc) = rhs(loc) + w(1,i+1); end;		if ( j == M ) 		   [p q r] = feval ( pqr, x(i+1) );		   rhs(loc) = rhs(loc) + 2*h*r/p; 		end;	end;end;[A, pvt] = LUfactor ( A );w1 = LUsolve ( A, rhs, pvt );for loc = 1 : N*M    r = 1 + floor ( (loc-1) / N );	c = 1 + mod ( (loc-1), N );	w(r+1,c+1) = w1(loc);end;