function [w, x, y] = curvedex ( N, TOL, Nmax, omega )x = linspace ( 0, 1, 4*N+1 );y = x;h = 1/(4*N);hsq = h*h;w = zeros ( 4*N+1, 4*N+1 );fmat = -1 * hsq * ones ( 4*N+1, 4*N+1 );extra = zeros ( 1, 2*N+1 );mr = zeros ( 4*N+1, 2*N+1 );mb = zeros ( 4*N+1, 2*N+1 );for j = 2 : 2*N    xcirc = 1 - sqrt ( 0.25 - y(j)^2 );	extra(j) = floor ( ( xcirc - 0.5 ) / h );	for i = 2*N+1 : 2*N+1+extra(j)	    ycirc = sqrt ( 0.25 - ( x(i) - 1 )^2 );		mr(i,j) = min ( [1, (xcirc-x(i))/h] );		mb(i,j) = min ( [1, (y(j)-ycirc)/h] );	end;end;extra(2*N+1) = 2*N-1;for i = 2*N+1 : 4*N	ycirc = sqrt ( 0.25 - ( x(i) - 1 )^2 );	mr(i,2*N+1) = 1;	mb(i,2*N+1) = min ( [1, (y(2*N+1)-ycirc)/h] );end;	for its = 1 : Nmax    res_norm = 0;	for j = 2 : 2*N+1	    for i = 2 : 2*N		    res = fmat(i,j) - ( w(i-1,j) + w(i+1,j) + w(i,j-1) + w(i,j+1) - 4 * w(i,j) );			w(i,j) = w(i,j) - omega*res/4;			if ( abs ( res ) > res_norm ) res_norm = abs(res); end;		end;		for i = 2*N+1 : 2*N+1+extra(j)		    res = fmat(i,j) - 2*( w(i-1,j)/(1+mr(i,j)) + w(i+1,j)/(mr(i,j)*(1+mr(i,j))) + w(i,j-1)/(mb(i,j)*(1+mb(i,j))) + w(i,j+1)/(1+mb(i,j)) - (1/mr(i,j) + 1/mb(i,j)) * w(i,j) );			w(i,j) = w(i,j) - omega*res/( 2 * (1/mr(i,j) + 1/mb(i,j)) );			if ( abs ( res ) > res_norm ) res_norm = abs(res); end;		end;	end;		for j = 2*N+2 : 4*N	    for i = 2 : 4*N		    res = fmat(i,j) - ( w(i-1,j) + w(i+1,j) + w(i,j-1) + w(i,j+1) - 4 * w(i,j) );			w(i,j) = w(i,j) - omega*res/4;			if ( abs ( res ) > res_norm ) res_norm = abs(res); end;		end;	end;		if ( res_norm < hsq*TOL ) disp(its); return; end;end; 	   