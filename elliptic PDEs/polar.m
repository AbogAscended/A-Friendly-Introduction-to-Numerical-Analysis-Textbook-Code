function [w, r, t] = polar ( r1, r2, N, t1, t2, M, TOL, Nmax, omega )r = linspace ( r1, r2, N+1 );t = linspace ( t1, t2, M+1 );dr = (r2-r1)/N;dt = (t2-t1)/M;dr2 = dr * dr;lambda = [ 0 dr2/(dt*dt)./(r(2:N).*r(2:N)) ];w = zeros ( N+1, M+1 );for i = 1 : N    w(i,M+1) = 4 - 2*r(i);end;for j = 2 : M    w(1,j) = 1 - cos(t(j));end;fmat = 0 * dr2 * ones ( N+1, M+1 );for its = 1 : Nmax    res_norm = 0;	for j = 2 : M	    for i = 2 : N		    new = ( 1 - omega ) * w(i,j) + omega * ( ( 1 - dr / (2*r(i)) ) * w(i-1,j) + ( 1 + dr / (2*r(i)) ) * w(i+1,j) + lambda(i) * w(i,j-1) + lambda(i) * w(i,j+1) - fmat(i,j) ) / ( 2 * ( 1 + lambda(i) ) );			res = w(i,j) - new;			w(i,j) = new;			if ( abs ( res ) > res_norm ) res_norm = abs(res); end;		end;	end;			if ( res_norm < TOL ) disp(its); return; end;end; 	   