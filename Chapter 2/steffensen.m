function y = steffensen ( f, x0, TOL, Nmax )%STEFFENSEN    locate the fixed point of an arbitrary function using %              Steffensen's method%%     calling sequences:%             y = steffensen ( 'g', x0, TOL, Nmax )%             steffensen ( 'g', x0, TOL, Nmax )%%     inputs:%             g       string containing name of m-file defining the%                     iteration function%             x0      initial approximation to location of fixed point%             TOL     absolute error convergence tolerance%             Nmax    maximum number of iterations to be performed%%     output:%             y       approximate value of fixed point%%     NOTE:%             if STEFFENSEN is called with no output arguments, the %             iteration number and the current approximation to the %             fixed point are displayed%%             if the maximum number of iterations is exceeded, a message%             to this effect will be displayed and the most recent%             approximation will be returned in the output value%p0 = x0;   phatold = x0;for i = 1 : Nmax    p1 = feval(f,p0);	p2 = feval(f,p1);		phat = p2 - ( p2 - p1 ) ^ 2 / ( p2 - 2 * p1 + p0 );		if ( nargout == 0 ) 	   disp ( sprintf ( '\t\t %3d \t %.19f \n', i, phat ) )	end		if ( abs(phat-phatold) < TOL )	   if ( nargout == 1 ) 	      y = phat;	   end	   return	else	   phatold = phat;	   p0 = phat;    endenddisp('Maximum number of iterations exceeded')if ( nargout == 1 ) y = phat; end