function check_stab ( NX, D, dt )r = linspace ( 0, 1, NX+1 );dr = 1 / NX;lambda = D * dt / dr^2;sub   = [ lambda * ( 1 - 0.5 ./ [1:NX-1] ), 2*lambda ];super = [ 4*lambda, lambda * ( 1 + 0.5 ./ [1:NX-1] ); ];diag  = ( 1 - 2 * lambda ) * ones ( 1, NX+1 );diag(1) = diag(1) - 2 * lambda; %diag(NX+1) = diag(NX+1) - 2 * dr * lambda * ( 1 + 0.5/NX );	A = zeros ( NX+1, NX+1 );for i = 1 : NX+1,   A(i,i) = diag(i);   end;for i = 1 : NX,   A(i,i+1) = super(i);   A(i+1,i) = sub(i);   end;H = red2hess ( A );rho = max ( abs ( qrhess ( H, 5e-16, 5 * NX ) ) ) ;% rho = power_method ( A, [1;zeros(NX,1)], 5e-6, 50000 );disp ( rho )