function [w, r, t] = ftcs_polar2 ( a,b, NX, t0, tf, NT, D, bc, f, source )r = linspace ( a, b, NX+1 );t = linspace ( t0, tf, NT+1 );dr = (b-a) / NX;dt = (tf-t0) / NT;lambda = D * dt / dr^2;mu = D * dt / dr;diag = 1 - 2 * lambda;wnew = zeros ( NX+1,1 );wold = zeros ( NX+1,1 );for i = 2 : NX    wold(i) = feval ( f, r(i) );end;[ wold(1) wold(NX+1) ] = feval ( bc, t0 );for j = 2 : NT+1        for i = 2 : NX	    wnew(i) = ( lambda - 0.5 * mu / r(i) ) * wold(i-1) + ( diag ) * wold(i) + ( lambda + 0.5 * mu / r(i) ) * wold(i+1) + dt * feval ( source, r(i), t(j-1) );	end;	[ wnew(1) wnew(NX+1) ] = feval ( bc, t(j) );		wold = wnew;end;w = wnew;