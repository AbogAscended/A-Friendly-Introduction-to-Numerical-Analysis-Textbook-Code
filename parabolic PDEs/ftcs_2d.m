function w = ftcs_2d ( a, b, NX, c, d, NY, t0, tf, NT, D, bcx, bcy, f, source, decay )x = linspace ( a, b, NX+1 );y = linspace ( c, d, NY+1 );t = linspace ( t0, tf, NT+1 );delta = (b-a) / NX;dt = (tf-t0) / NT;lambda = D * dt / delta^2;diag = 1 - 4 * lambda;wnew = zeros ( NX+1, NY+1 );wold = zeros ( NX+1, NY+1 );for j = 2 : NX    for k = 2 : NY        wold(j,k) = feval ( f, x(j), y(k) );	end;end;for j = 1 : NX+1    [ wold(j,1), wold(j,NY+1) ] = feval ( bcy, x(j), t(1) );end;for k = 2 : NY    [ wold(1,k), wold(NX+1,k) ] = feval ( bcx, y(k), t(1) );end;for n = 2 : NT+1    for j = 2 : NX	    for k = 2 : NY	    wnew(j,k) = lambda * ( wold(j-1,k) + wold(j+1,k) + wold(j,k-1) + wold(j,k+1) ) + ( diag - dt * feval ( decay, x(j), y(k), t(n-1) ) ) * wold(j,k) + dt * feval ( source, x(j), y(k), t(n-1) );	    end;	end;		for j = 1 : NX+1        [ wnew(j,1), wnew(j,NY+1) ] = feval ( bcy, x(j), t(1) );    end;    for k = 2 : NY        [ wnew(1,k), wnew(NX+1,k) ] = feval ( bcx, y(k), t(1) );    end;		wold = wnew;end;w = wnew;