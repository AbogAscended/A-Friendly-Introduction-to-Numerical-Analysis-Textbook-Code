function [w, r, t] = ftcs_polar ( a,b, NX, t0, tf, NT, D, bc, f )r = linspace ( a, b, NX+1 );t = linspace ( t0, tf, NT+1 );dr = (b-a) / NX;dt = (tf-t0) / NT;lambda = D * dt / dr^2;mu = D * dt / dr;diag = 1 - 2 * lambda;wnew = zeros ( NX+1,1 );wold = zeros ( NX+1,1 );for i = 1 : NX    wold(i) = feval ( f, r(i) );end;[ temp wold(NX+1) ] = feval ( bc, t0 );for j = 2 : NT+1    	wnew(1) = ( diag - 2 * lambda ) * wold(1) + 4 * lambda * wold(2);    for i = 2 : NX	    wnew(i) = ( lambda - 0.5 * mu / r(i) ) * wold(i-1) + ( diag ) * wold(i) + ( lambda + 0.5 * mu / r(i) ) * wold(i+1);	end;	[ temp wnew(NX+1) ] = feval ( bc, t(j) );		wold = wnew;end;w = wnew;