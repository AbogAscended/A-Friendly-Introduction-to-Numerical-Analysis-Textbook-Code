function [T, C] = photo1D ( NX, NT )x = linspace ( 0, 1, NX+1 );dx = 1 / NX;dt = ( 300 * 550 / 2.25e10 ) / NT;lambda = dt / dx^2;k1 = 8.3e-8 * 2.8e13 * (1.5e5)^2 / 550;k2 = 3.2e-10 * 2.8e13 * (1.5e5)^4 / 550^2;Tnew = zeros ( NX+1,1 );Told = zeros ( NX+1,1 );Cnew = zeros ( NX+1,1 );Cold = ones ( NX+1,1 );Cnew(1) = 1;  Cnew(NX+1) = 1;for i = 2 : NX	sv(i) = expose ( x(i) );end;sub   = -lambda * ones ( 1, NX-2 );super = sub;for j = 2 : NT+1	diag  = ( 1 + 2 * lambda) * ones ( 1, NX-1 ); 	for i = 2 : NX	    Cnew(i) = Cold(i) / ( 1 + dt * k2 * Told(i) );		diag(i-1) = diag(i-1) + dt * k1 * Cnew(i);	end;		rhs = Told(2:NX)' + dt*sv(2:NX);    Tnew(2:NX) = tridiagonal ( sub, diag, super, rhs );	Told = Tnew;	Cold = Cnew;end;T = Tnew;C = Cnew;function y =  expose ( x )if ( ( 0.1 <= x ) & ( x <= 0.2 ) )   y = 1; elseif ( ( 0.35 <= x ) & ( x <= 0.50 ) )   y = 1; elseif ( ( 0.62 <= x ) & ( x <= 0.69 ) )   y = 1;else   y = 0; end;