function yp = spline_der ( sp, x )%SPLINE_EVAL      evaluate the first derivative of a given spline function %                 at a specified set of values for the independent variable%%     calling sequences:%             yp = spline_der ( sp, x )%             spline_der ( sp, x )%%     inputs:%             sp      matrix containing the information which defines the%                     spline function%                     - typically this will be the output from either%                       LINEAR_SPLINE, CUBIC_NAK or CUBIC_CLAMPED%             x       value(s) of independent variable at which to%                     evalaute the spline function%                     - may be a scalar or a vector%%     output:%             yp      value(s) of the first derivative of the spline function%%     NOTE:%             this is a companion routine to the routines CUBIC_NAK,%             CUBIC_CLAMPED and LINEAR SPLINE%[p c] = size ( sp );npts = length ( x );for i = 1 : npts    piece = max ( find ( sp(1:p-1) < x(i) ) );    if ( length ( piece ) == 0 )       piece = 1;    end    temp(i) = sp(piece,3);    if ( c == 5 )       temp(i) = temp(i) + 2 * sp(piece,4) * ( x(i) - sp(piece,1) );	   temp(i) = temp(i) + 3 * sp(piece,5) * ( x(i) - sp(piece,1) )^2;    endendif ( nargout == 0 )   disp ( temp )else   yp = temp;end