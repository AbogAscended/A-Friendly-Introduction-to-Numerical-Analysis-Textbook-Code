function ls = linear_spline ( xi, fi )%LINEAR_SPLINE     compute the piecewise linear interpolant associated %                  with a given set of interpolating points and function %                  values%%     calling sequences:%             ls = linear_spline ( xi, fi )%             linear_spline ( xi, fi )%%     inputs:%             xi      vector containing the interpolating points%                     (must be sorted in ascending order)%             fi      vector containing function values%                     the i-th entry in this vector is the function%                     value associated with the i-th entry in the 'xi'%                     vector%%     output:%             ls      three column matrix containing the information which%                     defines the piecewise linear interpolant%                     - first column: interpolating points%                     - second column: function values%                     - third column: slopes of linear pieces%%     NOTE:%             to evaluate the piecewise linear interpolant apply the%             routine SPLINE_EVAL to the output of this routine %n = length ( xi );m = length ( fi );if ( n ~= m )   disp ( 'number of ordinates and number of function values must be equal' )   returnendb = zeros (n,1);b(1:n-1) = ( fi(2:n) - fi(1:n-1) ) ./ ( xi(2:n) - xi(1:n-1) );if ( nargout == 0 )   disp ( [ xi' fi' b ] )else   ls = [ xi' fi' b ];end