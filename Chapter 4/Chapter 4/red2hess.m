function H = red2hess ( A )%RED2HESS       perform similarity transformations to reduce the arbitrary%               matrix A to upper Hessenberg form%%     calling sequences:%             H = red2hess ( A )%             red2hess ( A )%%     input:%             A       square matrix to be reduced to upper Hessenberg form%%     output:%             H       upper Hessenberg matrix similar to input matrix A%[nrow ncol] = size ( A );if ( nrow ~= ncol )   disp ( 'red2hess error: square matrix required' );   return;end;for i = 2 : nrow - 1	t =  min ( find ( abs(A(i:nrow,i-1)) == max(abs(A(i:nrow,i-1))) ) + i-1 );	if ( i ~= t )	   temp = A(i,:);       A(i,:) = A(t,:);	   A(t,:) = temp;	   	   temp = A(:,i);	   A(:,i) = A(:,t);	   A(:,t) = temp;	end;			if ( A(i,i-1) ~= 0 )       for j = i+1 : nrow	       m = -A(j,i-1) / A(i,i-1);		   A(j,i-1) = 0;		   A(j, i:nrow) = A(j, i:nrow) + m * A(i, i:nrow);		   A(:, i) = A(:, i) - m * A(:, j);       end;	end;end;H = A;